
<!doctype html>
<html class="theme-next use-motion theme-next-mala">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






  <link rel="stylesheet" type="text/css" href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>


    <meta name="description" content="醉卧塌上看风轻云淡，漫卷诗书听雨打芭蕉" />



  <meta name="keywords" content="Android,Gradle," />



  <link rel="alternate" href="/atom.xml" title="Robin's blog" type="application/atom+xml" />



  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="前言  本篇将介绍一些Gradle相关知识、Gradle Wrapper 以及命令行工具的使用。">
<meta name="keywords" content="Android,Gradle">
<meta property="og:type" content="article">
<meta property="og:title" content="Android Gradle学习系列：（二）命令行和 Gradle Wrapper">
<meta property="og:url" content="http://whtacm.cc/2018/01/02/Android Gradle学习系列：（二）命令行和 Gradle Wrapper/index.html">
<meta property="og:site_name" content="Robin&#39;s blog">
<meta property="og:description" content="前言  本篇将介绍一些Gradle相关知识、Gradle Wrapper 以及命令行工具的使用。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://docs.gradle.org/current/userguide/img/commandLineTutorialTasks.png">
<meta property="og:updated_time" content="2018-04-11T13:55:11.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android Gradle学习系列：（二）命令行和 Gradle Wrapper">
<meta name="twitter:description" content="前言  本篇将介绍一些Gradle相关知识、Gradle Wrapper 以及命令行工具的使用。">
<meta name="twitter:image" content="https://docs.gradle.org/current/userguide/img/commandLineTutorialTasks.png">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mala',
    sidebar: '[object Object]'
  };
</script>

  <title> Android Gradle学习系列：（二）命令行和 Gradle Wrapper | Robin's blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  

  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?97551011862ccb1d84eef0bd7737cfc3";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">人淡如菊</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            <i class="menu-item-icon icon-next-categories"></i> <br />
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            <i class="menu-item-icon icon-next-about"></i> <br />
            关于
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    
      

      

    

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 

  <div id="posts" class="posts-expand">
    

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              Android Gradle学习系列：（二）命令行和 Gradle Wrapper
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2018-01-02T19:36:21+08:00" content="2018-01-02">
            2018-01-02
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Android/" itemprop="url" rel="index">
                  <span itemprop="name">Android</span>
                </a>
              </span>

              
              
                ， 
              

            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Android/Gradle/" itemprop="url" rel="index">
                  <span itemprop="name">Gradle</span>
                </a>
              </span>

              
              
                ， 
              

            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/Android/Gradle/Android-Studio/" itemprop="url" rel="index">
                  <span itemprop="name">Android Studio</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <!--
              <a href="/2018/01/02/Android Gradle学习系列：（二）命令行和 Gradle Wrapper/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2018/01/02/Android Gradle学习系列：（二）命令行和 Gradle Wrapper/" itemprop="commentsCount"></span>
              </a>
              -->
              <a href="/2018/01/02/Android Gradle学习系列：（二）命令行和 Gradle Wrapper/#comments" itemprop="discussionUrl">
                <span>评论</span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        <span itemprop="articleBody"><blockquote>
<p>前言</p>
</blockquote>
<p>本篇将介绍一些Gradle相关知识、Gradle Wrapper 以及命令行工具的使用。<br><a id="more"></a><br><br></p>
<h1 id="1、-gradle-目录"><a href="#1、-gradle-目录" class="headerlink" title="1、.gradle 目录"></a>1、.gradle 目录</h1><p><br></p>
<p>在介绍 Gradle 命令行工具以及 Wrapper 之前，还是想说一下关于 Gradle 的一些其他一些相关知识。这里主要想讲一点关于 <em>.gradle</em> 目录的内容，对于 Android 开发者来讲，应该多少都有了解。首先我们来看一下这个文件夹，在 Mac 系统下它可能是隐藏的，你可以通过 Android Studio -&gt; Preference -&gt; Build,Execution… -&gt; Build Tools -&gt; Gradle 面板，勾选 <em>“Use local gradle distribution”</em> 填入 “/Users/xxxx/.gradle”，然后点击选择文件目录查看。</p>
<p>或者在 Terminal 中输入以下命令 ：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">defaults write com<span class="selector-class">.apple</span><span class="selector-class">.finder</span> AppleShowAllFiles -bool true</div></pre></td></tr></table></figure>
<p>然后重启 Finder 就OK了。</p>
<p>现在，我们来看一下  <em>.gradle</em> 目录有哪些东西：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="bullet">+ </span>caches </div><div class="line"><span class="bullet">+ </span>daemon </div><div class="line"><span class="bullet">+ </span>native</div><div class="line"><span class="bullet">+ </span>workers</div><div class="line"><span class="bullet">+ </span>wrapper</div><div class="line">gradle.properties</div></pre></td></tr></table></figure>
<p>一般情况下，主要的目录和文件有这么几个。</p>
<ul>
<li><em>caches</em> 目录下存放了下载的依赖包，你可以通过 Android Studio -&gt; Preference -&gt; Build,Execution… -&gt; Build Tools -&gt; Gradle 面板，勾选 <em>“Use offline”</em> 来减少重复下载依赖包，加快 build 或者 sync 过程。此外，你还是向这里添加你自己的依赖包</li>
<li><em>daemon</em> 目录存放 Gradle 守护进程的输入日志信息，以版本号文件夹的形式进行分类。</li>
<li><em>wrapper</em> 目录存放不同版本的 Gradle 包，Gradle Wrapper 会下载和使用这里的 Gradle 进行项目构建。由于敏感的原因，有时候会出现长时间的 building ，这可能是由于下载相应的 Gradle 太慢或者没响应造成的，建议去国内的站点下载相应的 Gradle 版本的 .zip文件，放在这个 wrapper/dists 目录下面，再次打开项目进行构建</li>
<li><em>gradle.properties</em> 文件，这一个 Gradle 全局配置文件，可以在这里配置守护、jvmargs、全局字段（比如keystore的信息）等</li>
<li>其他，比如 <em>native</em> 目录、worker 目录</li>
</ul>
<p>OK，关于 Gradle 而言，关于 .gradle 目录基本要了解的内容就这么多，相比于 Maven 这类的依赖管理的工具来说，就是有一个配套的仓库（caches）来存放使用的依赖。多出来的一个重要内容就是多了一个自身版本的管理器，这个我们在第三部分来说。</p>
<p><br></p>
<h1 id="2、Gradle-命令行"><a href="#2、Gradle-命令行" class="headerlink" title="2、Gradle 命令行"></a>2、Gradle 命令行</h1><p><br></p>
<p>平时的 Android 开发中，通过界面上的 <em>Run</em> 按钮来打包和安装 apk，这一些列动作，主要是靠 Gradle 命令来完成的。基本上，我们不太去直接使用命令行来进行打包。但是实际上，我们还是需要了解和学习这一过程。<em><u>本文使用的 Gradle 版本是 3.3， 没有特别指明的话，本系列后续篇幅中 Gradle 均为此版本</u></em>。<br><br></p>
<h2 id="2-1、tasks-命令"><a href="#2-1、tasks-命令" class="headerlink" title="2.1、tasks 命令"></a>2.1、tasks 命令</h2><p><br><br>在 Terminal 中使用该命令，你将会看到这样的输出信息：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">&gt; gradle tasks</div><div class="line">Parallel execution <span class="keyword">with</span> configuration <span class="keyword">on</span> <span class="title">demand</span> <span class="title">is</span> <span class="title">an</span> <span class="title">incubating</span> <span class="title">feature</span>.</div><div class="line">:tasks</div><div class="line"></div><div class="line"><span class="comment">------------------------------------------------------------</span></div><div class="line">All tasks runnable <span class="built_in">from</span> root project</div><div class="line"><span class="comment">------------------------------------------------------------</span></div><div class="line"></div><div class="line">Build Setup tasks</div><div class="line"><span class="comment">-----------------</span></div><div class="line">init - Initializes <span class="keyword">a</span> <span class="built_in">new</span> Gradle build. [incubating]</div><div class="line">wrapper - Generates Gradle wrapper <span class="built_in">files</span>. [incubating]</div><div class="line"></div><div class="line">Help tasks</div><div class="line"><span class="comment">----------</span></div><div class="line">buildEnvironment - Displays all buildscript dependencies declared <span class="keyword">in</span> root project <span class="string">'gradle'</span>.</div><div class="line">components - Displays <span class="keyword">the</span> components produced <span class="keyword">by</span> root project <span class="string">'gradle'</span>. [incubating]</div><div class="line">dependencies - Displays all dependencies declared <span class="keyword">in</span> root project <span class="string">'gradle'</span>.</div><div class="line">dependencyInsight - Displays <span class="keyword">the</span> insight <span class="keyword">into</span> <span class="keyword">a</span> specific dependency <span class="keyword">in</span> root project <span class="string">'gradle'</span>.</div><div class="line">dependentComponents - Displays <span class="keyword">the</span> dependent components <span class="keyword">of</span> components <span class="keyword">in</span> root project <span class="string">'gradle'</span>. [incubating]</div><div class="line">help - Displays <span class="keyword">a</span> help message.</div><div class="line">model - Displays <span class="keyword">the</span> configuration model <span class="keyword">of</span> root project <span class="string">'gradle'</span>. [incubating]</div><div class="line">projects - Displays <span class="keyword">the</span> sub-projects <span class="keyword">of</span> root project <span class="string">'gradle'</span>.</div><div class="line">properties - Displays <span class="keyword">the</span> properties <span class="keyword">of</span> root project <span class="string">'gradle'</span>.</div><div class="line">tasks - Displays <span class="keyword">the</span> tasks runnable <span class="built_in">from</span> root project <span class="string">'gradle'</span>.</div><div class="line"></div><div class="line">To see all tasks <span class="keyword">and</span> more detail, run gradle tasks <span class="comment">--all</span></div><div class="line"></div><div class="line">To see more detail about <span class="keyword">a</span> task, run gradle help <span class="comment">--task &lt;task&gt;</span></div><div class="line"></div><div class="line">BUILD SUCCESSFUL</div><div class="line"></div><div class="line">Total <span class="built_in">time</span>: <span class="number">0.607</span> <span class="built_in">secs</span></div></pre></td></tr></table></figure>
<p>这里列出了一些项目可以允许的 task 列表，分为了两组任务（当然，你可以为任务配置分组信息，这里可能会有更多的分组），一是构建配置任务<em>（</em>Build Setup tasks<em>）</em>，参考 2.2；一是帮助任务<em>（</em>Help tasks<em>）</em> 这些可以帮助你掌握项目的一些信息，比如依赖、属性、包括的子项目。<br><br></p>
<h2 id="2-2、init-和-wrapper"><a href="#2-2、init-和-wrapper" class="headerlink" title="2.2、init 和 wrapper"></a>2.2、init 和 wrapper</h2><p><br><br>假如你想从零开始一个项目，你可以试试</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span><span class="bash"> gradle init</span></div></pre></td></tr></table></figure>
<p>它可以帮助你生成一些文件，包括以下文件和目录：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+ gradle 目录，包括 wrapper 配置</div><div class="line">graldew</div><div class="line">gradlew<span class="selector-class">.bat</span></div><div class="line">build<span class="selector-class">.gradle</span> 文件，项目的根 build 文件</div><div class="line">settings<span class="selector-class">.gradle</span> 项目的设置文件，常规的就是项目的组织和配置信息</div></pre></td></tr></table></figure>
<p>使用 wrapper 这个命令，可以帮助你生成 gradle 目录、gradlew 以及 gradlew.bat 文件，这样一来，需要团队协作的项目可以统一 Gradle 的版本（构建环境）。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;</span><span class="bash"> gradle wrapper</span></div></pre></td></tr></table></figure>
<p><br></p>
<h2 id="2-3、多任务执行"><a href="#2-3、多任务执行" class="headerlink" title="2.3、多任务执行"></a>2.3、多任务执行</h2><p><br><br>Gradle 使用有向无环图来决定一条任务执行的路径，任务之间可以有依赖关系。你可以同时执行多个任务，只需要用空格分割多个任务就OK，并且任务仅被执行一次。例如 build.gradle 文件的内容是这样的：</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">task</span> <span class="keyword">compile</span> &#123;</div><div class="line">    <span class="keyword">doLast</span> &#123;</div><div class="line">        <span class="keyword">println</span> <span class="string">'compiling source'</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">task</span> compileTest(dependsOn: <span class="keyword">compile</span>) &#123;</div><div class="line">    <span class="keyword">doLast</span> &#123;</div><div class="line">        <span class="keyword">println</span> <span class="string">'compiling unit tests'</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">task</span> test(dependsOn: [<span class="keyword">compile</span>, compileTest]) &#123;</div><div class="line">    <span class="keyword">doLast</span> &#123;</div><div class="line">        <span class="keyword">println</span> <span class="string">'running unit tests'</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">task</span> dist(dependsOn: [<span class="keyword">compile</span>, test]) &#123;</div><div class="line">    <span class="keyword">doLast</span> &#123;</div><div class="line">        <span class="keyword">println</span> <span class="string">'building the distribution'</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>OK， 你可以看得出来，任务之间的依赖性是这样的，如下图所示。</p>
<p><img src="https://docs.gradle.org/current/userguide/img/commandLineTutorialTasks.png" alt="图2-1"></p>
<p align="center"> <code>图2-1</code> </p>

<p>当执行 gradle dist compile ，执行 dist 和 compile 任务时，在控制台你可以看到如下信息：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; gradle dist compile</div><div class="line">Parallel execution <span class="keyword">with</span> configuration <span class="keyword">on</span> demand <span class="keyword">is</span> an incubating feature.</div><div class="line">:compile</div><div class="line">compiling source</div><div class="line">:compileTest</div><div class="line">compiling unit tests</div><div class="line">:test</div><div class="line"><span class="built_in">running</span> unit tests</div><div class="line">:dist</div><div class="line">building <span class="keyword">the</span> distribution</div><div class="line"></div><div class="line">BUILD SUCCESSFUL</div><div class="line"></div><div class="line">Total <span class="built_in">time</span>: <span class="number">0.611</span> secs</div></pre></td></tr></table></figure>
<p>如果，你去掉 dist 里的参数，即去掉对 compile 和 test 对依赖，在执行该命令，会得到一下的输出信息。这样进一步验证了 Gradle 在执行多任务时候按照任务在命令行里列出的先后顺序执行，当一个任务已经执行过了，在后面列出来了也会被跳过不执行。</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; gradle dist compile</div><div class="line">Parallel execution <span class="keyword">with</span> configuration <span class="keyword">on</span> <span class="title">demand</span> <span class="title">is</span> <span class="title">an</span> <span class="title">incubating</span> <span class="title">feature</span>.</div><div class="line">:dist</div><div class="line">building <span class="keyword">the</span> distribution</div><div class="line">:compile</div><div class="line">compiling source</div><div class="line"></div><div class="line">BUILD SUCCESSFUL</div><div class="line"></div><div class="line">Total <span class="built_in">time</span>: <span class="number">0.784</span> <span class="built_in">secs</span></div></pre></td></tr></table></figure>
<p><br></p>
<h2 id="2-4、排除任务的-x-选项"><a href="#2-4、排除任务的-x-选项" class="headerlink" title="2.4、排除任务的 -x 选项"></a>2.4、排除任务的 -x 选项</h2><p><br><br>你可以排除某个任务不被执行，只需要使用 -x 选项并后接任务名。想要排除多个任务，你要多次使用 <em>-x 任务名</em> 的方式来进行操作。比如：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; gradle dist -x compile -x compileTest</div><div class="line">Parallel execution <span class="keyword">with</span> configuration <span class="keyword">on</span> demand <span class="keyword">is</span> an incubating feature.</div><div class="line">:test</div><div class="line"><span class="built_in">running</span> unit tests</div><div class="line">:dist</div><div class="line">building <span class="keyword">the</span> distribution</div><div class="line"></div><div class="line">BUILD SUCCESSFUL</div><div class="line"></div><div class="line">Total <span class="built_in">time</span>: <span class="number">0.606</span> secs</div></pre></td></tr></table></figure>
<p><br></p>
<h2 id="2-5-continue-选项"><a href="#2-5-continue-选项" class="headerlink" title="2.5 --continue 选项"></a>2.5 --continue 选项</h2><p><br><br>Gradle 在执行任务失败时会默认的中止构建，这样一来会使整个构建工作完成，但是会把一些可能会失败的问题隐藏起来。为了能够在单次构建的执行中发现更多的问题，你可以使用 <em>—continue</em> 选项。</p>
<p>使用该选项，可以执行所有依赖任务没有失败的任务，在构建完成后，失败信息会被报告。</p>
<p>如果任务失败，基于安全的考虑，依赖于它的后续任务将不被执行。例如，在<em>图2-1</em>中，<em>test</em> 依赖的任务如果执行失败， <em>test</em> 任务将停止执行。</p>
<p><br></p>
<h2 id="2-6、任务名缩写"><a href="#2-6、任务名缩写" class="headerlink" title="2.6、任务名缩写"></a>2.6、任务名缩写</h2><p><br></p>
<p>在执行任务时，你不必写出完整的任务名。你只需要提供足够的信息能够唯一确定该任务就OK了。例如，在上面的例子中，你可以使用 <em>di</em> 代替 <em>dist</em>。</p>
<p>另外，你还可以对驼峰式的名字中进行缩写。比如，使用 <em>compTest</em> 甚至是 <em>cT</em> 来替代 <em>compileTest</em>。</p>
<p><br></p>
<h2 id="2-7、选择-build"><a href="#2-7、选择-build" class="headerlink" title="2.7、选择 build"></a>2.7、选择 build</h2><p><br></p>
<p>当使用 <em>gradle</em> 时，默认会查找当前目录的 <em>build.gradle</em> 文件。你可以使用 <em>-b</em> 选项来选择 build 文件。例如：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; gradle -<span class="selector-tag">q</span> -<span class="selector-tag">b</span> subdir/myproject<span class="selector-class">.gradle</span> hello</div></pre></td></tr></table></figure>
<p>该命令会选择 <em>subdir</em> 目录下的 <em>myproject.gradle</em> 文件并执行 <em>hello</em> 任务。</p>
<p>或者，使用 <em>-p</em> 选项来指定项目目录。对于多项目构建使用 <em>-p</em> 选项而非 <em>-b</em> 选项。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; gradle -<span class="selector-tag">q</span> -<span class="selector-tag">p</span> subdir hello</div></pre></td></tr></table></figure>
<p>该命令使用 <em>subdir</em> 目录下的 <em>build.gradle</em> 文件并执行 <em>hello</em> 任务。另外，<em>如果没有该文件会报错</em>。</p>
<p><br></p>
<h2 id="2-8、强制执行-rerun-tasks-选项"><a href="#2-8、强制执行-rerun-tasks-选项" class="headerlink" title="2.8、强制执行 --rerun-tasks 选项"></a>2.8、强制执行 --rerun-tasks 选项</h2><p><br></p>
<p>许多任务，特别是 Gradle 自身提供的，都支持增量构建 <em>（incremental builds）</em>。此类任务是否需要执行，取决于最近一次执行后输入输出是否有改变。在构建过程中，你可以看到一些被标记了 <em>UP-TO-DATE</em> 的任务，它们是不需要再次被执行的。</p>
<p>有时候，你可能需要执行所有的任务，忽略一些 up-to-date 检查。使用 <em>--rerun-tasks</em> 可以帮助你完成该项工作。</p>
<p>这一步会强制那些有必要执行的任务被执行。这有点类似 <em>clean</em> 操作，唯一的不同的在于它不会删除 build 后生成的 output。<br><br></p>
<h2 id="2-9、-获取-build-信息"><a href="#2-9、-获取-build-信息" class="headerlink" title="2.9、 获取 build 信息"></a>2.9、 获取 build 信息</h2><p><br></p>
<p>该部分，针对2.1中的帮助任务进行一些介绍。</p>
<p><br></p>
<h3 id="2-9-1、项目清单"><a href="#2-9-1、项目清单" class="headerlink" title="2.9.1、项目清单"></a>2.9.1、项目清单</h3><p><br></p>
<p>运行 <em>gradle projects</em> 命令会列出项目的所有子项目信息。下面是一个使用 projects 命令获取的信息：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; gradle projects</div><div class="line"></div><div class="line"><span class="comment">------------------------------------------------------------</span></div><div class="line">Root project</div><div class="line"><span class="comment">------------------------------------------------------------</span></div><div class="line"></div><div class="line">Root project <span class="string">'task'</span></div><div class="line">+<span class="comment">--- Project ':app' - The shared API for the application</span></div><div class="line">\<span class="comment">--- Project ':robin.test'</span></div><div class="line"></div><div class="line">To see <span class="keyword">a</span> list <span class="keyword">of</span> <span class="keyword">the</span> tasks <span class="keyword">of</span> <span class="keyword">a</span> project, run gradle &lt;project-path&gt;:tasks</div><div class="line">For example, <span class="keyword">try</span> running gradle :app:tasks</div><div class="line"></div><div class="line">BUILD SUCCESSFUL</div><div class="line"></div><div class="line">Total <span class="built_in">time</span>: <span class="number">0.723</span> <span class="built_in">secs</span></div></pre></td></tr></table></figure>
<p>如果在项目的 <em>build.gradle</em> 中指定了描述属性（如下），也会在 Terminal 中显示。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">description</span> = <span class="string">'The shared API for the application'</span></div></pre></td></tr></table></figure>
<p><br></p>
<h3 id="2-9-2、任务清单-tasks命令"><a href="#2-9-2、任务清单-tasks命令" class="headerlink" title="2.9.2、任务清单 tasks命令"></a>2.9.2、任务清单 tasks命令</h3><p><br></p>
<p>在开始的时候，我们已经介绍了该命令。此处会展开一点讲一下。例如，我们有下面这个 build.gradle 文件：</p>
<figure class="highlight puppet"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">task <span class="keyword">clean</span> &#123;</div><div class="line">	<span class="literal">description</span> = <span class="string">'Deletes the build directory (build)'</span></div><div class="line">    <span class="literal">group</span> = <span class="string">'build'</span></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">task</span> <span class="keyword">libs</span> &#123;</div><div class="line">	<span class="literal">description</span> = <span class="string">'Builds the JAR'</span></div><div class="line">    <span class="literal">group</span> = <span class="string">'build'</span></div><div class="line"></div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="keyword">task</span> <span class="keyword">dists</span> &#123;</div><div class="line">   <span class="literal">description</span> = <span class="string">'Builds the distribution'</span></div><div class="line">    <span class="literal">group</span> = <span class="string">'build'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">task</span> <span class="keyword">test</span> &#123;</div><div class="line">	<span class="literal">description</span> = <span class="string">'Test task'</span></div><div class="line">    <span class="literal">group</span> = <span class="string">'build'</span></div><div class="line">     doLast &#123;</div><div class="line">        println(<span class="string">'do during execution phrase'</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>执行命令后：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="section">&gt; gradle -q tasks</span></div><div class="line">------------------------------------------------------------</div><div class="line"><span class="section">All tasks runnable from root project</span></div><div class="line">------------------------------------------------------------</div><div class="line"></div><div class="line"><span class="section">Build tasks</span></div><div class="line">-----------</div><div class="line">clean - Deletes the build directory (build)</div><div class="line">dists - Builds the distribution</div><div class="line">libs - Builds the JAR</div><div class="line">test - Test task</div><div class="line"></div><div class="line"><span class="section">Build Setup tasks</span></div><div class="line">-----------------</div><div class="line">init - Initializes a new Gradle build. [incubating]</div><div class="line">wrapper - Generates Gradle wrapper files. [incubating]</div><div class="line">....</div></pre></td></tr></table></figure>
<p><em>Build tasks</em> 中的任务前三个是 Gradle 自身提供的，而 <em>test</em> 是我们定义的，我们通过添加 <em>group</em> 分组的方式将它们放在了一起。这些任务叫做可见任务<em>（visible tasks）</em>。</p>
<p>使用 <em>--all</em> 选项，你可以获取更多的任务信息。包括项目下的那些没有进行分组的任务，即隐藏任务<em>（hidden tasks）</em> 。<br><br></p>
<h3 id="2-9-3、任务使用详情"><a href="#2-9-3、任务使用详情" class="headerlink" title="2.9.3、任务使用详情"></a>2.9.3、任务使用详情</h3><p><br></p>
<p>使用 <em>gradle help –task someTask</em> 可以获取指定任务或多个任务的信息。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; gradle -q help --task libs</div><div class="line">Detailed task information <span class="keyword">for</span> libs</div><div class="line"></div><div class="line">Paths</div><div class="line">     :api:libs</div><div class="line">     :webapp:libs</div><div class="line"><span class="built_in"></span></div><div class="line">Type</div><div class="line">     Task (org.gradle.api.Task)</div><div class="line"></div><div class="line">Description</div><div class="line">     Builds the JAR</div><div class="line"><span class="built_in"></span></div><div class="line">Group</div><div class="line">     build</div></pre></td></tr></table></figure>
<p>这些信息包括完整任务路径、任务类型、可能的命令行选项以及描述信息等。<br><br></p>
<h3 id="2-9-4、依赖清单"><a href="#2-9-4、依赖清单" class="headerlink" title="2.9.4、依赖清单"></a>2.9.4、依赖清单</h3><p><br></p>
<p><em>gradle dependencies</em> 命令可以获取选中的项目依赖信息，默认是现在根项目<em>（Root project）</em>的。你可以通过指定 <em>项目:dependencies</em> 的方式来添加子项目。例如：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&gt; gradle -q dependencies api:dependencies webapp:dependencies</div><div class="line"></div><div class="line"><span class="code">------------------------------------------------------------</span></div><div class="line">Root project</div><div class="line">------------------------------------------------------------</div><div class="line"></div><div class="line">No configurations</div><div class="line"></div><div class="line"><span class="code">------------------------------------------------------------</span></div><div class="line">Project :api - The shared API for the application</div><div class="line">------------------------------------------------------------</div><div class="line"></div><div class="line">compile</div><div class="line">\--- org.codehaus.groovy:groovy-all:2.4.10</div><div class="line"></div><div class="line">testCompile</div><div class="line">\--- junit:junit:4.12</div><div class="line"><span class="code">     \--- org.hamcrest:hamcrest-core:1.3</span></div><div class="line"></div><div class="line"><span class="code">------------------------------------------------------------</span></div><div class="line">Project :webapp - The Web application implementation</div><div class="line">------------------------------------------------------------</div><div class="line"></div><div class="line">compile</div><div class="line">+--- project :api</div><div class="line">|    \--- org.codehaus.groovy:groovy-all:2.4.10</div><div class="line">\--- commons-io:commons-io:1.2</div><div class="line"></div><div class="line">testCompile</div><div class="line">No dependencies</div></pre></td></tr></table></figure>
<p>由于依赖报告可能会很大，因此通过配置来简化报告，该操作可使用 <em>—configuration</em> 选项：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt; gradle -q api:dependencies --configuration testCompile</div><div class="line"></div><div class="line"><span class="code">------------------------------------------------------------</span></div><div class="line">Project :api - The shared API for the application</div><div class="line">------------------------------------------------------------</div><div class="line"></div><div class="line">testCompile</div><div class="line">\--- junit:junit:4.12</div><div class="line"><span class="code">     \--- org.hamcrest:hamcrest-core:1.3</span></div></pre></td></tr></table></figure>
<p><br></p>
<h3 id="2-9-5、项目buildscript依赖清单"><a href="#2-9-5、项目buildscript依赖清单" class="headerlink" title="2.9.5、项目buildscript依赖清单"></a>2.9.5、项目buildscript依赖清单</h3><p><br></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;</span><span class="bash"> gradle buildEnvironment</span></div></pre></td></tr></table></figure>
<p><br></p>
<h3 id="2-9-6、深入依赖"><a href="#2-9-6、深入依赖" class="headerlink" title="2.9.6、深入依赖"></a>2.9.6、深入依赖</h3><p><br></p>
<p>通过该命令可以深入指定的依赖包，例如：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="selector-tag">gradle</span> <span class="selector-tag">-q</span> <span class="selector-tag">webapp</span><span class="selector-pseudo">:dependencyInsight</span> <span class="selector-tag">--dependency</span> <span class="selector-tag">groovy</span> <span class="selector-tag">--configuration</span> <span class="selector-tag">compile</span></div><div class="line"><span class="selector-tag">org</span><span class="selector-class">.codehaus</span><span class="selector-class">.groovy</span><span class="selector-pseudo">:groovy-all</span><span class="selector-pseudo">:2.4.10</span></div><div class="line">\<span class="selector-tag">---</span> <span class="selector-tag">project</span> <span class="selector-pseudo">:api</span></div><div class="line">     \<span class="selector-tag">---</span> <span class="selector-tag">compile</span></div></pre></td></tr></table></figure>
<p><br></p>
<h3 id="2-9-7、项目属性清单"><a href="#2-9-7、项目属性清单" class="headerlink" title="2.9.7、项目属性清单"></a>2.9.7、项目属性清单</h3><p><br><br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; gradle -<span class="selector-tag">q</span> api:properties</div><div class="line"></div><div class="line">------------------------------------------------------------</div><div class="line">Project :api - The shared API <span class="keyword">for</span> the application</div><div class="line">------------------------------------------------------------</div><div class="line"></div><div class="line">allprojects: [project <span class="string">':api'</span>]</div><div class="line">ant: org<span class="selector-class">.gradle</span><span class="selector-class">.api</span><span class="selector-class">.internal</span><span class="selector-class">.project</span><span class="selector-class">.DefaultAntBuilder</span>@<span class="number">12345</span></div><div class="line">antBuilderFactory: org<span class="selector-class">.gradle</span><span class="selector-class">.api</span><span class="selector-class">.internal</span><span class="selector-class">.project</span><span class="selector-class">.DefaultAntBuilderFactory</span>@<span class="number">12345</span></div><div class="line">artifacts: org<span class="selector-class">.gradle</span><span class="selector-class">.api</span><span class="selector-class">.internal</span><span class="selector-class">.artifacts</span><span class="selector-class">.dsl</span><span class="selector-class">.DefaultArtifactHandler_Decorated</span>@<span class="number">12345</span></div><div class="line">asDynamicObject: DynamicObject <span class="keyword">for</span> project <span class="string">':api'</span></div><div class="line">baseClassLoaderScope: org<span class="selector-class">.gradle</span><span class="selector-class">.api</span><span class="selector-class">.internal</span><span class="selector-class">.initialization</span><span class="selector-class">.DefaultClassLoaderScope</span>@<span class="number">12345</span></div><div class="line">buildDir: /home/user/gradle/samples/userguide/tutorial/projectReports/api/build</div><div class="line">buildFile: /home/user/gradle/samples/userguide/tutorial/projectReports/api/build.gradle</div></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="2-10、-profile选项"><a href="#2-10、-profile选项" class="headerlink" title="2.10、--profile选项"></a>2.10、--profile选项</h2><p><br><br><em>—profile</em> 选项可以帮助你记录构建过程中的一些时间信息，并会生成一份报告位于 <em>`build/reports/profile</em> 目录。</p>
<p>profile 会汇总配置阶段和任务执行的时间和详情。并按时间长短从大到小排序，还将指示任务是否被跳过。</p>
<p>如果项目中有 <em>buildSrc</em> 目录，还将在 <em>buildSrc/build</em> 目录下还将生产一个 profile 文件。</p>
<p><em>PS： profile 文件主要帮助你来进行 build 阶段的优化工作，找出瓶颈，使用合适的方法去解决它。</em><br><br></p>
<h2 id="2-11、空运行-Dry-Run"><a href="#2-11、空运行-Dry-Run" class="headerlink" title="2.11、空运行 Dry Run"></a>2.11、空运行 Dry Run</h2><p><br><br>有时候你可能对于命令行中的任务的执行顺序会感兴趣，但是又不想任务被真正执行。这时候，你可以使用 <em>-m</em> 选项。例如:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="selector-tag">gradle</span> <span class="selector-tag">-m</span> <span class="selector-tag">clean</span> <span class="selector-tag">dists</span></div><div class="line"><span class="selector-pseudo">:clean</span> <span class="selector-tag">SKIPPED</span></div><div class="line"><span class="selector-pseudo">:dists</span> <span class="selector-tag">SKIPPED</span></div><div class="line"></div><div class="line"><span class="selector-tag">BUILD</span> <span class="selector-tag">SUCCESSFUL</span></div><div class="line"></div><div class="line"><span class="selector-tag">Total</span> <span class="selector-tag">time</span>: 0<span class="selector-class">.66</span> <span class="selector-tag">secs</span></div></pre></td></tr></table></figure>
<p><br></p>
<h1 id="3、Gradle-Wrapper"><a href="#3、Gradle-Wrapper" class="headerlink" title="3、Gradle Wrapper"></a>3、Gradle Wrapper</h1><p><br></p>
<p>之前说到 Android 项目基于 Gradle 以及 Plugin 进行构建，不同的项目的 Gradle 环境（版本）不同，同一个项目可能需要在一个 team 中进行开发，需要 Gradle 环境保持一致。因此，这就产生了 Gradle Wrapper。Wrapper 是一个管理 Gradle 版本的工具，这有点类似于 Node 的 NVM，可以安装、卸载 Node 版本，也可以切换 Node 版本。<br><br></p>
<h2 id="3-1、使用-Wrapper-进行-build"><a href="#3-1、使用-Wrapper-进行-build" class="headerlink" title="3.1、使用 Wrapper 进行 build"></a>3.1、使用 Wrapper 进行 build</h2><p><br></p>
<p>假如项目配置了 Wrapper，你可以在项目根目录下执行下列命令：</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; ./gradlew</div><div class="line">Downloading https:<span class="comment">//services.gradle.org/distributions/gradle-3.3-bin.zip</span></div><div class="line">..............................................................................................................................................................</div><div class="line">Unzipping /User/xxxxxxxx/.gradle/wrapper/dists/gradle<span class="number">-3.3</span>-bin/<span class="number">64</span>bhckfm0iuu9gap9hg3r7ev2/gradle<span class="number">-3.3</span>/bin/gradle</div><div class="line"></div><div class="line">BUILD SUCCESSFUL</div><div class="line"></div><div class="line">Total time: <span class="number">57.793</span> secs</div></pre></td></tr></table></figure>
<p>每个 Wrapper 都会指定一个 Gradle 版本，因此，当你执行命令的时候。首先它会去下载该版本然后去 build。</p>
<blockquote>
<p>IDEs</p>
<p>如果通过 wrapper 把项目导入 IDE 中去，可能会提示你使用 ‘all’ 发布。这能够给 IDE 提供更完整的代码去build 文件。</p>
</blockquote>
<p>使用 Wrapper，不仅免去了 Gradle 的下载工作，还保证了版本的一致。这样保证你所有的历史 build 的可靠。命令和 <em>gradle</em> 相似。</p>
<p>在 <em>$USER_HOME/.gradle/wrapper/dists</em> 目录下，你能够找到这些 <em>Gradle</em> 发布。<br><br></p>
<h2 id="3-2、添加Wrapper"><a href="#3-2、添加Wrapper" class="headerlink" title="3.2、添加Wrapper"></a>3.2、添加Wrapper</h2><p><br></p>
<p>在上一节中，我们可以通过 <em>wrapper</em> 来为项目添加 Wrapper。默认的，它使用当前的 Gradle 版本的 ‘bin’ 发布（文件体积最小），当然，你可以通过 <em>--gradle-version</em> 来指定版本。类似 Android Studio 这类的开发工具使用 ‘all’ 发布。你可以使用 <em>--distribution-type</em> 来指定发布的类型，使用 <em>--gradle-distribution-url</em> 来指定发布的下载地址。如果不指定版本或者 url ，则使用默认的配置。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="selector-tag">gradle</span> <span class="selector-tag">wrapper</span> <span class="selector-tag">--gradle-version</span> 2<span class="selector-class">.0</span></div><div class="line"><span class="selector-pseudo">:wrapper</span></div><div class="line"></div><div class="line"><span class="selector-tag">BUILD</span> <span class="selector-tag">SUCCESSFUL</span></div><div class="line"></div><div class="line"><span class="selector-tag">Total</span> <span class="selector-tag">time</span>: 0<span class="selector-class">.759</span> <span class="selector-tag">secs</span></div></pre></td></tr></table></figure>
<p> 或者在 <em>build.gradle</em> 中配置一个 Wrapper 任务来指定版本，然后执行该任务：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">task wrapper(type: Wrapper) &#123;</div><div class="line"><span class="code">    gradleVersion = '2.0'</span></div><div class="line"><span class="section">&#125;</span></div><div class="line">-----------------------------------------------</div><div class="line">&gt; gradle wrapper</div><div class="line">:wrapper</div><div class="line"></div><div class="line">BUILD SUCCESSFUL</div><div class="line"></div><div class="line">Total time: 0.668 secs</div></pre></td></tr></table></figure>
<p>执行完后，在项目下会添加一些文件：</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby">gradlew</span></div><div class="line">-<span class="ruby">gradlew.bat</span></div><div class="line">+gradle/wrapper/</div><div class="line">  -<span class="ruby">gradle-wrapper.jar</span></div><div class="line">  -<span class="ruby">gradle-wrapper.properties</span></div></pre></td></tr></table></figure>
<p>之后，你应该使用 <em>gradlew</em> 命令 build 项目，使用方式和 <em>gradle</em> 一样 。如果你想更换版本，只需要修改 <em>gradle-wrapper.properties</em> 文件即可。<br><br></p>
<h2 id="3-3、配置"><a href="#3-3、配置" class="headerlink" title="3.3、配置"></a>3.3、配置</h2><p><br></p>
<p>默认的，Android 项目在创建时，已经配置了 wrapper。当然，你也可以通过 <em>gradle wrapper</em> 命令行来添加 Wrapper。Wrapper 位于项目根目录下的 <em>gradle/wrapper</em> 下面，里面有一个 <em>jar</em> 包还有一个配置文件 <em>gradle-wrapper.properties</em> ：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Sun May 01 11:23:33 CST 2016</span></div><div class="line"><span class="attr">distributionBase</span>=GRADLE_USER_HOME</div><div class="line"><span class="attr">distributionPath</span>=wrapper/dists</div><div class="line"><span class="attr">zipStoreBase</span>=GRADLE_USER_HOME</div><div class="line"><span class="attr">zipStorePath</span>=wrapper/dists</div><div class="line"><span class="attr">distributionUrl</span>=https\://services.gradle.org/distributions/gradle-<span class="number">3.3</span>-all.zip</div></pre></td></tr></table></figure>
<p>这里面有个五个配置项，但是前面四个是两两组合使用的。<em>distributionBase + distributionPath</em> 指定了该版本的 Gradle 在此目录下存放，如果没有就查找有没有下载 <em>zip</em> 文件。<em>zipStoreBase + zipStorePath</em> 指定了 <em>zip</em> 文件存放的位置，如果该文件不存在就去 <em>distributionUrl</em> 地址去下载。这几个地址均是可配的，当然一般来说是不需要动的。</p>
<p><strong><em>唯一一个需要说明的是：</em></strong>通常卡在 build 时，可能是由于下载 Gradle 时造成的。你可以去国内的站点去下载 Gradle，然后放在 <em>dists</em> 目录或者修改 <em>distributionUrl</em> 为 <em>file\:///your_file_path/gradle-x.x-all.zip</em>，然后进行 build。<br><br></p>
<h2 id="3-4、下载认证"><a href="#3-4、下载认证" class="headerlink" title="3.4、下载认证"></a>3.4、下载认证</h2><p><br></p>
<p>这一部分主要针对哪些私有受保护的服务器，可能需要 HTTP Basic 认证。在 <em>.gradle/gradle.properties</em> 文件中添加一下配置信息：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">systemProp<span class="selector-class">.gradle</span><span class="selector-class">.wrapperUser</span>=username</div><div class="line">systemProp<span class="selector-class">.gradle</span><span class="selector-class">.wrapperPassword</span>=password</div></pre></td></tr></table></figure>
<p>然后修改 <em>gradle/wrapper/gradle-wrapper.properties</em> 文件的 <em>distributionUrl</em> 属性，加入认证信息。</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">distributionUrl=https://username:password<span class="symbol">@somehost</span>/path/<span class="keyword">to</span>/gradle-distribution.zip</div></pre></td></tr></table></figure>
<p>更多信息可以查看 <a href="https://docs.gradle.org/current/userguide/build_environment.html#sec:accessing_the_web_via_a_proxy" target="_blank" rel="external"><em>Section 12.3, “Accessing the web via a proxy”</em></a><br><br></p>
<h2 id="3-5、验证发布文件"><a href="#3-5、验证发布文件" class="headerlink" title="3.5、验证发布文件"></a>3.5、验证发布文件</h2><p><br><br>你可以下载 <em>.sha256</em> 文件对下载的发布进行验证是否被篡改。或者在 <em>gradle-wrapper.properties</em> 文件中使用 <em>distributionSha256Sum</em> 进行验证：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">distributionSha256Sum</span>=<span class="number">371</span>cb9fbebbe9880d147f59bab36d61eee122854ef8c9ee1ecf12b82368bcf10</div></pre></td></tr></table></figure>
<p><br></p>
<h2 id="3-6、Unix-文件权限"><a href="#3-6、Unix-文件权限" class="headerlink" title="3.6、Unix 文件权限"></a>3.6、Unix 文件权限</h2><p><br><br>Unix 系统的文件权限问题时很头痛的，这会带来很多问题。根据官网的建议，Unix 系统你应该时刻使用 <em>sh gradlew</em> 这样的命令。</p>
<p><br></p>
<h1 id="4、最后"><a href="#4、最后" class="headerlink" title="4、最后"></a>4、最后</h1><p><br><br>本篇介绍了关于 Gradle 的一些基本知识，还有命令的一些基础使用，了解了 Wrapper 是什么，能干什么。下一章，我们来谈谈 Build 环境的配置。<br><br></p>
</span>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Android/" rel="tag">#Android</a>
          
            <a href="/tags/Gradle/" rel="tag">#Gradle</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/01/05/Android Gradle学习系列：（三）Build 环境配置--上篇/" rel="prev">Android Gradle学习系列：（三）Build 环境配置--上篇</a>
            
          </div>

          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/01/01/Android Gradle学习系列：（一）初识Gradle/" rel="next">Android Gradle学习系列：（一）初识Gradle</a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div>
      
        <style type="text/css">

    .donate_bar {
        text-align: center;
        margin-top : 5%;
    }

    .donate_bar.hidden {
        display:none;
    }
/*
    .donate_bar a.btn_donate {
        display: inline-block;
        width: 82px;
        height: 82px;
        margin-left:auto;
        margin-right:auto;

        background: url("http://img.t.sinajs.cn/t5/style/images/apps_PRF/e_media/btn_reward.gif") no-repeat;
        _background: url("http://img.t.sinajs.cn/t5/style/images/apps_PRF/e_media/btn_reward.gif") no-repeat; 

        -webkit-transition: background 0s;
        -moz-transition: background 0s;
        -o-transition: background 0s;
        -ms-transition: background 0s;
        transition: background 0s;
    }
*/
    .donate_bar a.btn_donate:hover { 
        // background-position: 0px -82px;
        color: #87daff
    }

    .donate_bar .donate_txt {
        display: block;
        color: #9d9d9d;
        font: 14px/2 "Microsoft Yahei";
    }

    .bold { 
        font-weight: bold; 
    }

    .post-donate a {
        border-bottom: 0px;
    }

    #donate_guide table {
        border: none;
    }

    #donate_guide td {
        border-bottom: none;
        border-right: none;
        background: #333333;
        valign: top;
    }

</style>



    

    <div class ="post-donate">
        <div id="donate_board" class="donate_bar center">
              <a id="btn_donate" class="btn_donate" href="javascript:;" title="打赏">赏</a>
              <span id="donate_txt" class="donate_txt">
                   
                        请我喝杯茶
                   
              </span>
            <br>
        </div>  
  
        <div id="donate_guide" class="donate_bar center hidden">
            <!--
            
                <a href="http://ofdub8np7.bkt.clouddn.com/pay/alipay.png" title="支付宝打赏" class="fancybox" rel="article0" 
                    style="float:left;margin-left:25%;margin-right:10px;">
                    <img src="http://ofdub8np7.bkt.clouddn.com/pay/alipay.png" title="" height="164px" width="164px">
                </a> 
              

            
                <a href="http://ofdub8np7.bkt.clouddn.com/pay/wechat.png" title="微信打赏" class="fancybox" rel="article0"
                    style="margin-right:30%">
                    <img src="http://ofdub8np7.bkt.clouddn.com/pay/wechat.png" title="" height="164px" width="164px">
                </a>
            
            -->
            <table>
                <tr>
                    <td>
                        
                            <a href="http://ofdub8np7.bkt.clouddn.com/pay/alipay.png" title="支付宝打赏" class="fancybox" rel="article0" 
                                style="float:left;margin-left:25%;margin-right:10px;">
                                <img src="http://ofdub8np7.bkt.clouddn.com/pay/alipay.png" title="" height="164px" width="164px">
                            </a> 
                         
                    </td>
                    <td>
                        
                            <a href="http://ofdub8np7.bkt.clouddn.com/pay/wechat.png" title="微信打赏" class="fancybox" rel="article0"
                                style="margin-right:30%">
                                <img src="http://ofdub8np7.bkt.clouddn.com/pay/wechat.png" title="" height="164px" width="164px">
                            </a>
                        
                    </td>
                </tr>
            </table>

        </div>

        <script type="text/javascript">
            document.getElementById('btn_donate').onclick = function() {
                $('#donate_board').addClass('hidden');
                // $('#donate_guide').removeClass('hidden');
                $('#donate_guide').show(2000);
            }

        </script>
    </div>

    


      
    </div>

    <div class="post-spread">
      
    </div>
  </div>

 </div>

        

        
          <div class="comments" id="comments">
            
              <div class="ds-thread" data-thread-key="2018/01/02/Android Gradle学习系列：（二）命令行和 Gradle Wrapper/"
                   data-title="Android Gradle学习系列：（二）命令行和 Gradle Wrapper" data-url="http://whtacm.cc/2018/01/02/Android Gradle学习系列：（二）命令行和 Gradle Wrapper/">
              </div>
            
          </div>
        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="Robin" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Robin</p>
        </div>
        <p class="site-description motion-element" itemprop="description">醉卧塌上看风轻云淡，漫卷诗书听雨打芭蕉</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">20</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">16</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">26</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="menu-item-icon icon-next-feed"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/whtacm" target="_blank">GitHub</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="whtacm@gmail.com" target="_blank">Gmail</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="364432355" target="_blank">QQ</a>
              </span>
            
          
        </div>

        <div class="links-of-friendly motion-element">
          
            <p class="site-author-name">Links</p>
            
              <span class="links-of-author-item">
              <a href="https://hexo.io/" target="_blank">Hexo</a>
              </span>
            
              <span class="links-of-author-item">
              <a href="http://theme-next.iissnan.com/getting-started.html" target="_blank">NexT</a>
              </span>
            
          
        </div>

        
        

      </section>

      
        <section class="post-toc-wrap sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator"></div>
          <div class="post-toc">
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1、-gradle-目录"><span class="nav-number">1.</span> <span class="nav-text">1、.gradle 目录</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2、Gradle-命令行"><span class="nav-number">2.</span> <span class="nav-text">2、Gradle 命令行</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1、tasks-命令"><span class="nav-number">2.1.</span> <span class="nav-text">2.1、tasks 命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2、init-和-wrapper"><span class="nav-number">2.2.</span> <span class="nav-text">2.2、init 和 wrapper</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3、多任务执行"><span class="nav-number">2.3.</span> <span class="nav-text">2.3、多任务执行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4、排除任务的-x-选项"><span class="nav-number">2.4.</span> <span class="nav-text">2.4、排除任务的 -x 选项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-continue-选项"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 --continue 选项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-6、任务名缩写"><span class="nav-number">2.6.</span> <span class="nav-text">2.6、任务名缩写</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-7、选择-build"><span class="nav-number">2.7.</span> <span class="nav-text">2.7、选择 build</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-8、强制执行-rerun-tasks-选项"><span class="nav-number">2.8.</span> <span class="nav-text">2.8、强制执行 --rerun-tasks 选项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-9、-获取-build-信息"><span class="nav-number">2.9.</span> <span class="nav-text">2.9、 获取 build 信息</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-1、项目清单"><span class="nav-number">2.9.1.</span> <span class="nav-text">2.9.1、项目清单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-2、任务清单-tasks命令"><span class="nav-number">2.9.2.</span> <span class="nav-text">2.9.2、任务清单 tasks命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-3、任务使用详情"><span class="nav-number">2.9.3.</span> <span class="nav-text">2.9.3、任务使用详情</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-4、依赖清单"><span class="nav-number">2.9.4.</span> <span class="nav-text">2.9.4、依赖清单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-5、项目buildscript依赖清单"><span class="nav-number">2.9.5.</span> <span class="nav-text">2.9.5、项目buildscript依赖清单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-6、深入依赖"><span class="nav-number">2.9.6.</span> <span class="nav-text">2.9.6、深入依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-7、项目属性清单"><span class="nav-number">2.9.7.</span> <span class="nav-text">2.9.7、项目属性清单</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-10、-profile选项"><span class="nav-number">2.10.</span> <span class="nav-text">2.10、--profile选项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-11、空运行-Dry-Run"><span class="nav-number">2.11.</span> <span class="nav-text">2.11、空运行 Dry Run</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3、Gradle-Wrapper"><span class="nav-number">3.</span> <span class="nav-text">3、Gradle Wrapper</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1、使用-Wrapper-进行-build"><span class="nav-number">3.1.</span> <span class="nav-text">3.1、使用 Wrapper 进行 build</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2、添加Wrapper"><span class="nav-number">3.2.</span> <span class="nav-text">3.2、添加Wrapper</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3、配置"><span class="nav-number">3.3.</span> <span class="nav-text">3.3、配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4、下载认证"><span class="nav-number">3.4.</span> <span class="nav-text">3.4、下载认证</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5、验证发布文件"><span class="nav-number">3.5.</span> <span class="nav-text">3.5、验证发布文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6、Unix-文件权限"><span class="nav-number">3.6.</span> <span class="nav-text">3.6、Unix 文件权限</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4、最后"><span class="nav-number">4.</span> <span class="nav-text">4、最后</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator"></div>
        </section>
      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="copyright" >
  
  &copy; &nbsp;  2016 - 
  <span itemprop="copyrightYear">2021
  </span>
  <span class="with-love">
    <i class="icon-next-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Robin
  </span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme by <a class="theme-link" href="http://whtacm.cc">Robin</a>.<a class="theme-link" href="https://github.com/whtacm/hexo-theme-next/tree/magiclamp">Mala</a>
</div>

<!-- busuanzi -->

  <div class="busuanzi-info">
    <div class="theme-info">
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
    <span id="busuanzi_container_site_pv">
        本站总访问量<a class="theme-link"><span id="busuanzi_value_site_pv"></span></a>次
    </span>
</div>
  </div>



 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  
  
    

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"whtacm"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    

    
  
  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/lib/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.1" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 0.4 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    var $tocContent = $('.post-toc-content');
    if (isDesktop() && CONFIG.sidebar === 'post') {
      if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
        displaySidebar();
      }
    }
  });
</script>



  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  

  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
</body>
</html>
